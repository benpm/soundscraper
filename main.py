from random import randint
from time import sleep, time
import sched
from hueInterface import createBridgeConn, setLight, flashLight

def main():
    # check for a credential file / create conn
    bridge = createBridgeConn("auth.txt", "10.0.0.91")

    # create a lights resource
    lights = bridge.lights

    # Turn on all lights, set brightness to max, min transition time
    for index in range(1, 4):
        setLight(lights[index], bri=254, transitiontime=0, on=True)

    events = [0.11609977, 0.55727891, 0.99845805, 1.46285714, 1.92725624, 2.39165533, 
              2.83283447, 3.29723356, 3.76163265, 4.22603175, 4.69043084, 5.15482993, 
              5.61922902, 6.08362812, 6.52480726, 6.98920635, 7.45360544, 7.91800454, 
              8.38240363, 8.87002268, 9.31120181, 9.77560091, 10.24, 10.70439909, 
              11.14557823, 11.60997732, 12.07437642, 12.53877551, 13.0031746, 13.4675737, 
              13.93197279, 14.39637188, 14.83755102, 15.27873016, 15.74312925, 16.20752834, 
              16.67192744, 17.11310658, 17.60072562, 18.04190476, 18.52952381, 18.97070295, 
              19.43510204, 19.89950113, 20.36390023, 20.80507937, 21.29269841, 21.73387755, 
              22.2214966, 22.66267574, 23.12707483, 23.59147392, 24.05587302, 24.49705215,
              24.96145125, 25.42585034, 25.91346939, 26.35464853, 26.81904762, 27.28344671,
              27.7478458, 28.18902494, 28.65342404, 29.11782313, 29.60544218, 30.06984127, 
              30.53424036, 30.9754195, 31.43981859, 31.88099773, 32.36861678, 32.83301587, 
              33.29741497, 33.7385941, 34.2029932, 34.66739229, 35.13179138, 35.57297052, 
              36.06058957, 36.52498866, 36.98938776, 37.43056689, 37.89496599, 38.35936508, 
              38.82376417, 39.26494331, 39.75256236, 40.21696145, 40.68136054, 41.12253968, 
              41.58693878, 42.05133787, 42.51573696, 42.9569161, 43.44453515, 43.88571429, 
              44.37333333, 44.83773243, 45.30213152, 45.76653061, 46.20770975, 46.67210884, 
              47.13650794, 47.60090703, 48.06530612, 48.52970522, 48.99410431, 49.4585034, 
              49.92290249, 50.38730159, 50.85170068, 51.29287982, 51.75727891, 52.221678, 
              52.6860771, 53.15047619, 53.61487528, 54.05605442, 54.52045351, 54.98485261, 
              55.4492517, 55.91365079, 56.37804989, 56.84244898, 57.30684807, 57.77124717, 
              58.23564626, 58.6768254, 59.14122449]

    scheduler = sched.scheduler(time, sleep)

    for sec in events:
        scheduler.enter(sec, 1, flashLight, argument=(lights, randint(1, 3)), kwargs={'hue': randint(0, 65535)})
    
    scheduler.run()

if __name__ == "__main__":
    main()